<!--Form for borrow a book-->
<div>
  <%= form_for(borrow_book_path, :url => borrow_book_path(@book.id), :method => 'post', :html => {:id => 'borrow_form'}) do |f| %>

      <div class="book_profile">
        <div class="book_image_section">
          <%= image_tag(@book.image_link, class: 'book_image') %>
        </div>

        <div class="book_metadata">

          <% if current_user.role == 'Admin' %>
              <button type="button" class="btn" id='edit_icon' onclick="editDetails()">
                <span class="glyphicon glyphicon-pencil"></span>
              </button>
          <% end %>

          <h4 id="book_title"><%= @book.title %></h4>

          <p class="author_name">
            <label class="author_label">Author </label>:&nbsp;&nbsp;
            <%= @book.author ? @book.author : '-' %>
          </p>

          <p id="number_of_copies">
            <label class="number_of_copies_label">Number Of Copies &nbsp;</label>: &nbsp;
            <%= @book.number_of_copies ? @book.number_of_copies : '-' %>
          </p>

          <p id="page_count">
            <label class="number_of_pages_label">Number of pages </label>: &nbsp;
            <%= @book.page_count ? @book.page_count : '-' %>
          </p>

          <p id="publisher"><label class="publisher_label">Publisher </label>: &nbsp;
            <%= @book.publisher && @book.publisher != '' ? @book.publisher : '-' %>
          </p>

          <p id="isbn"><label class="isbn_label">ISBN </label>: &nbsp;<%= @book.isbn %></p>

          <% if @book.external_link %>
              <div class="books-external-links">Click <%= link_to "here", @book.external_link, target: '_blank', id: "books-external-links" %>
                for more details
              </div>
          <% end %>

          <% if @borrow_button_state == 'show' %>
              <button id="borrow_book" class="btn btn-success borrow_button">Borrow Book</button>
          <% elsif @borrow_button_state == 'disabled' %>
              <button id="borrow_book" class="btn btn-info disabled borrow_button" class="btn btn-success">Borrow Book
              </button>
          <% end %>

          <% if current_user.role == 'Admin' %>
              <%= hidden_field_tag id="book_id", value="#{@book.id}" %>
              <%= select_tag 'view-log-dropdown', options_for_select(@book_copies.map { |copy| ["Copy #{copy.copy_id}"] }.unshift(['View Log'])), :onchange => 'fetchCopyLogs(this.selectedIndex)', class: 'view-log' %>
          <% end %>
        </div>
        <% if @book.description && @book.description != '' %>
            <div id="description"><p class="description_label">Description</p>

              <p><%= @book.description %></p></div>
        <% end %>
        <% if @tags.present? %>
            <div class='book_tags'>
              <% @tags.each do |tag_text| %>
                  <span class="tag"> <%= tag_text %> </span>
              <% end %>
            </div>
        <% end %>
        <div id="book_copy_logs">
          <table id="book_copy" class="table table-striped table-bordered table-hover table-fixed">
            <thead id="header">
            <tr>
              <th>Name</th>
              <th>Borrow Date</th>
              <th>Return Date</th>
            </tr>
            </thead>
            <tbody id="logs"></tbody>
          </table>
        </div>
  <% end %>
  </div>
  <!--Form for update a book -->
  <%= form_for(update_book_path, :url => update_book_path(@book.id), :method => 'put', :html => {:id => 'edit_form', :hidden => 'hidden'}) do |f| %>
      <div class="book_profile" xmlns="http://www.w3.org/1999/html">
        <div class="book_image_section">
          <%= image_tag(@book.image_link, class: 'book_image') %>
        </div>

        <div class="book_metadata">
          <%= text_field_tag('title', @book.title, id: 'book_title', class: 'editable_field') %>

          <p class="author_name">
            <label class="author_label">Author </label>:&nbsp;&nbsp;
            <%= text_field_tag('author', @book.author, id: 'author_name', class: 'editable_field') %>
          </p>

          <p id="number_of_copies">
            <label class="number_of_copies_label">Number Of Copies &nbsp;</label>: &nbsp;
            <%= @book.number_of_copies ? @book.number_of_copies : '-' %>
          </p>

          <p id="page_count">
            <label class="number_of_pages_label">Number of pages </label>: &nbsp;
            <%= number_field_tag('page_count', @book.page_count, id: 'number_of_pages_count', class: 'editable_field', max: '99999',type:'number' ) %>
          </p>

          <p id="publisher">
            <label class="publisher_label">Publisher </label>: &nbsp;
            <%= text_field_tag('publisher', @book.publisher, id: 'publisher', class: 'editable_field') %>

          </p>

          <p id="isbn">
            <label class="isbn_label">ISBN </label>: &nbsp;
            <%= text_field_tag('isbn', @book.isbn, id: 'isbn', class: 'editable_field') %>
          </p>

          <% if @book.external_link %>
              <label class="external_link_label">External Link</label>: &nbsp;
              <%= text_field_tag('external_link', @book.external_link, id: 'external_url', class: 'editable_field') %>
          <% end %>

        </div>
        <% if @book.description && @book.description != '' %>
            <div id="description"><p class="description_label">Description</p>
              <p><%= @book.description %></p></div>
        <% end %>
      <% if @tags.present? %>
          <%= javascript_tag do %>
              window.tags = <%= @tags.to_json.html_safe %>;
          <% end %>
          <%= text_field_tag('tags', '', id: 'tags_confirm') %>
      <% end %>
        <div id="save_cancel_button">
          <button type="submit" class="btn" id='ok_icon'>
            Save
          </button>

          <button type="button" class="btn" id='remove_icon' onclick='history.go(0)'>
            Cancel
          </button>
        </div>
      </div>

  <% end %>
