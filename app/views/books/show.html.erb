<%= form_for(borrow_book_path, { :url => borrow_book_path(@book.id), :method => 'post' }) do |f| %>

    <div class="book_profile" xmlns="http://www.w3.org/1999/html">
      <div class="book_image_section">
        <%= image_tag(@book.image_link, class: 'book_image') %>
      </div>

      <div class="book_metadata">
        <h4 id="book_title"><%= @book.title %></h4>

        <p class="author_name">
          <label class="author_label">Author </label>:&nbsp;&nbsp;
          <%= @book.author && @book.author != '' ? @book.author : '-' %>
        </p>

        <p id="isbn">
          <label class="isbn_label">ISBN </label>: &nbsp;
          <%= @book.isbn && @book.isbn != '' ? @book.isbn : '-'%>
        </p>

        <p id="publisher"><label class="publisher_label">Publisher </label>: &nbsp;
          <%= @book.publisher && @book.publisher != '' ? @book.publisher : '-' %>
        </p>

        <p id="page_count">
          <label class="number_of_pages_label">Number Of Pages </label>: &nbsp;
          <%= @book.page_count && @book.page_count != '' ? @book.page_count : '-' %>
        </p>

        <p id="number_of_copies">
          <label class="number_of_copies_label">Total Copies &nbsp;</label>: &nbsp;
          <%= @book.number_of_copies && @book.number_of_copies != '' ? @book.number_of_copies : '-' %>
        </p>

        <% if @book.external_link %>
            <div class="books-external-links">Click <%= link_to "here", @book.external_link, target: '_blank', id:"books-external-links"%> for more details</div>
        <%end%>

        <% if @borrow_button_state == 'show' %>
            <button id="borrow_book" class="btn btn-success borrow_button">Borrow Book</button>
        <% elsif @borrow_button_state == 'disabled' %>
            <button id="borrow_book" class="btn btn-info disabled borrow_button" class="btn btn-success">Borrow Book</button>
        <% end %>

        <% if current_user.role == 'Admin' %>
           <%= select_tag 'view-log-dropdown', options_for_select(@book_copies.map{|copy| ["Copy #{copy.book_id}-#{copy.copy_id}"]}.unshift(['View Log'])),  :onchange=> 'fetchCopyLogs(this.selectedIndex)', class:'view-log'%>
        <% end %>
      </div>
    </div>

    <% if @book.description %>
        <div id="description"><h3 class="description_label">Description</h3><p><%= @book.description %></p></div>
    <%end%>

    <% if @tags.present? %>
        <div class= 'book_tags'>
          <% @tags.each do |tag_text| %>
            <span class="tag"> <%= tag_text %> </span>
          <% end %>
        </div>
    <% end %>
<% end %>
<div id="book_copy_logs">
  <table id="book_copy" class="table table-striped table-bordered table-hover table-fixed">
    <thead id="header">
    <tr>
      <th>Name</th>
      <th>Borrow Date</th>
      <th>Return Date</th>
    </tr>
    </thead>
    <tbody id="logs"></tbody>
  </table>
</div>
